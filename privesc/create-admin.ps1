function create_admin {
    [CmdletBinding()]
    param (
        [string] $admin_username,
        [securestring] $admin_password_secure
    )    
    begin {
    }    
    process {
        New-LocalUser "$admin_username" -Password $admin_password_secure -FullName "$admin_username" -Description "Temporary local admin"
        Write-Verbose "$admin_username local user crated"
        Add-LocalGroupMember -Group "Administrators" -Member "$admin_username"
        Write-Verbose "$admin_username added to the local administrator group"
    }    
    end {
    }
}

Remove-LocalUser -Name "admin-user"
$admin_username = "admin-user"
$admin_password = "password"
$admin_password_secure = (ConvertTo-SecureString $admin_password -AsPlainText -Force)
create_admin -admin_username $admin_username -CBFXIYeWPR $admin_password_secure
